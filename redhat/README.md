Here the explanation about how RedHat is wrong when it write that this PE is available only by console access.
![alt text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/RedHat_statement.png) </br>
</br>
from the original RedHat CVE bulletin </br>
[RHEL bulletin](https://access.redhat.com/security/cve/cve-2018-14665)



The real statement is that using the default SElinux settings </br> 
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/selinux.png)</br>
and the default configuration about xserver PAM module </br>
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/PAM_xserver.png) </br>
the PE can work also with a SSH session. </br>
</br>
The only condition that have to be met for this PE to work via SSH is that the legitimate non-root user has to be logged in trought console at the moment of the PE script launc. </br>
In fact during the logged session of the legitimate non-root user,a file with the name of the non-root user will be created in the `/var/run/console`. With that file present, the same non-root user can launch a Xorg command via SSH. </br>


</br>
###### When the console folder is empty if nobody is logged via console
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/console_empty.png)
</br>
###### In this conditions the PE does not work

</br>
###### login of legitimate non-root user</br>
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/login1.png)
</br>
###### session opened for the legitimate non-root user
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/login2.png)
</br>
###### check the console folder now
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/console_ready.png)
</br>
###### With the file created the Xorg command can be excuted via SSH
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/xorg_OK.png)
</br>
###### And the PE spawn a root shell
![alt_text](https://github.com/bolonobolo/CVE-2018-14665/blob/master/img/xorg_PE.png)

